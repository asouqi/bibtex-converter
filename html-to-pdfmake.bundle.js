(self.webpackChunkbibtex_converter=self.webpackChunkbibtex_converter||[]).push([[739],{57:function(e){function t(e,t){"use strict";this.wndw=t&&t.window?t.window:window,this.tableAutoSize=!(!t||"boolean"!=typeof t.tableAutoSize)&&t.tableAutoSize,this.fontSizes=t&&Array.isArray(t.fontSizes)?t.fontSizes:[10,14,16,18,20,24,28],this.defaultStyles={b:{bold:!0},strong:{bold:!0},u:{decoration:"underline"},del:{decoration:"lineThrough"},s:{decoration:"lineThrough"},em:{italics:!0},i:{italics:!0},h1:{fontSize:24,bold:!0,marginBottom:5},h2:{fontSize:22,bold:!0,marginBottom:5},h3:{fontSize:20,bold:!0,marginBottom:5},h4:{fontSize:18,bold:!0,marginBottom:5},h5:{fontSize:16,bold:!0,marginBottom:5},h6:{fontSize:14,bold:!0,marginBottom:5},a:{color:"blue",decoration:"underline"},strike:{decoration:"lineThrough"},p:{margin:[0,5,0,10]},ul:{marginBottom:5,marginLeft:5},table:{marginBottom:5},th:{bold:!0,fillColor:"#EEEEEE"}},this.changeDefaultStyles=function(){for(var e in t.defaultStyles)if(this.defaultStyles.hasOwnProperty(e))if(t.defaultStyles.hasOwnProperty(e)&&!t.defaultStyles[e])delete this.defaultStyles[e];else for(var a in t.defaultStyles[e])""===t.defaultStyles[e][a]?delete this.defaultStyles[e][a]:this.defaultStyles[e][a]=t.defaultStyles[e][a];else for(var r in this.defaultStyles[e]={},t.defaultStyles[e])this.defaultStyles[e][r]=t.defaultStyles[e][r]},t&&t.defaultStyles&&this.changeDefaultStyles(),this.convertHtml=function(e){var t=(new this.wndw.DOMParser).parseFromString(e,"text/html"),a=this.parseElement(t.body,[]);return a.stack||a.text},this.parseElement=function(e,a){var r,n,o,i,s=e.nodeName.toUpperCase(),l=s.toLowerCase(),c={text:[]},f=this;if(["COLGROUP","COL"].indexOf(s)>-1)return"";switch(e.nodeType){case 3:if(e.textContent){r=e.textContent;var u=this.parseStyle(a[a.length-1],!0),h=!1;for(o=0;o<u.length;o++)if("preserveLeadingSpaces"===u[o].key){h=u[o].value;break}if(h||(r=e.textContent.replace(/\n(\s+)?/g,"")),t&&"function"==typeof t.replaceText&&(r=t.replaceText(r,a)),["TABLE","THEAD","TBODY","TFOOT","TR","UL","OL"].indexOf(a[a.length-1].nodeName)>-1&&(r=r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),r)return c={text:r},c=this.applyStyle({ret:c,parents:a})}return"";case 1:switch(c.nodeName=s,a.push(e),e.childNodes&&e.childNodes.length>0&&([].forEach.call(e.childNodes,(function(e){var t=f.parseElement(e,a);t&&(Array.isArray(t.text)&&0===t.text.length&&(t.text=""),c.text.push(t))})),this.searchForStack(c)?(c.stack=c.text.slice(0),delete c.text):c=this.applyStyle({ret:c,parents:a})),a.pop(),s){case"TABLE":var d,p;c.table={body:[]};var y=c.stack||c.text;if(Array.isArray(y)){d=0;var g=[];y.forEach((function(e){var t=e.stack||e.text;Array.isArray(t)&&(g=g.concat(t),t.forEach((function(e){var t=e.stack||e.text;Array.isArray(t)&&(p=0,c.table.body[d]=[],t.forEach((function(e){if(c.table.body[d].push(e),e.colSpan)for(o=e.colSpan,f.setRowSpan({rows:g,cell:e,rowIndex:d,cellIndex:p});--o>0;)c.table.body[d].push({text:""}),f.setRowSpan({rows:g,cell:e,rowIndex:d,cellIndex:p}),p++;else f.setRowSpan({rows:g,cell:e,rowIndex:d,cellIndex:p});p++})),d++)})))}))}if(delete c.stack,delete c.text,c=this.applyStyle({ret:c,parents:a.concat([e])}),this.tableAutoSize){var b=[],x=[],m=[],k=[];c.table.body.forEach((function(e,t){b.push([]),x.push([]),e.forEach((function(e){var a=void 0!==e.width?e.width:"auto",r=void 0!==e.height?e.height:"auto";"auto"!==a&&e.colSpan&&(isNaN(a)?a="auto":a/=e.colSpan),"auto"!==r&&e.rowSpan&&(isNaN(r)?r="auto":r/=e.colSpan),b[t].push(a),x[t].push(r)}))})),b.forEach((function(e){e.forEach((function(e,t){var a=typeof m[t];("undefined"===a||"auto"!==e&&"number"===a&&e>m[t]||"auto"!==e&&"auto"===m[t])&&(m[t]=e)}))})),x.forEach((function(e,t){e.forEach((function(e){var a=typeof k[t];("undefined"===a||"auto"!==e&&"number"===a&&e>k[t]||"auto"!==e&&"auto"===k[t])&&(k[t]=e)}))})),m.length>0&&(c.table.widths=m),k.length>0&&(c.table.heights=k)}if(e.dataset&&e.dataset.pdfmake){"'"===(n=e.dataset.pdfmake).charAt(1)&&(n=n.replace(/'/g,'"'));try{for(i in n=JSON.parse(n))"layout"===i?c.layout=n[i]:c.table[i]=n[i]}catch(e){console.error(e)}}break;case"TH":case"TD":e.getAttribute("rowspan")&&(c.rowSpan=1*e.getAttribute("rowspan")),e.getAttribute("colspan")&&(c.colSpan=1*e.getAttribute("colspan")),c=this.applyStyle({ret:c,parents:a.concat([e])});break;case"SVG":c={svg:e.outerHTML.replace(/\n(\s+)?/g,""),nodeName:"SVG",style:["html-svg"]};break;case"BR":c.text=[{text:"\n"}];break;case"SUB":case"SUP":c[s.toLowerCase()]={offset:"30%",fontSize:8};break;case"HR":var S={width:514,type:"line",margin:[0,12,0,12],thickness:.5,color:"#000000",left:0};if(e.dataset&&e.dataset.pdfmake)for(i in n=JSON.parse(e.dataset.pdfmake))S[i]=n[i];c.margin=S.margin,c.canvas=[{type:S.type,x1:S.left,y1:0,x2:S.width,y2:0,lineWidth:S.thickness,lineColor:S.color}],delete c.text;break;case"OL":case"UL":c[l]=(c.stack||c.text).slice(0),delete c.stack,delete c.text,((c=this.applyStyle({ret:c,parents:a.concat([e])})).listStyle||c.listStyleType)&&(c.type=c.listStyle||c.listStyleType);break;case"IMG":c.image=e.getAttribute("src"),delete c.stack,delete c.text,c=this.applyStyle({ret:c,parents:a.concat([e])});break;case"A":c.link=e.getAttribute("href");break;case"FONT":if(e.getAttribute("color")&&(c.color=this.parseColor(e.getAttribute("color"))),e.getAttribute("size")){var v=Math.min(Math.max(1,parseInt(e.getAttribute("size"))),7),w=Math.max(this.fontSizes[0],this.fontSizes[v-1]);c.fontSize=w}c=this.applyStyle({ret:c,parents:a.concat([e])});break;default:t&&"function"==typeof t.customTag&&(c=t.customTag.call(this,{element:e,parents:a,ret:c}))}if(Array.isArray(c.text)&&1===c.text.length&&c.text[0].text&&!c.text[0].nodeName&&(c.text=c.text[0].text),-1===["HR","TABLE"].indexOf(s)&&e.dataset&&e.dataset.pdfmake)for(i in n=JSON.parse(e.dataset.pdfmake))c[i]=n[i];return c}},this.searchForStack=function(e){if(Array.isArray(e.text))for(var t=0;t<e.text.length;t++){if(e.text[t].stack||["P","DIV","TABLE","SVG","UL","OL","IMG","H1","H2","H3","H4","H5","H6"].indexOf(e.text[t].nodeName)>-1)return!0;if(!0===this.searchForStack(e.text[t]))return!0}return!1},this.setRowSpan=function(e){if(e.cell.rowSpan)for(var t=1;t<=e.cell.rowSpan-1;t++)(e.rows[e.rowIndex+t].text||e.rows[e.rowIndex+t].stack).splice(e.cellIndex,0,{text:""})},this.applyStyle=function(e){var t=[],a=e.parents.length-1,r=this;return e.parents.forEach((function(n,o){var i,s=n.nodeName.toLowerCase(),l="html-"+s;"html-body"!==l&&-1===t.indexOf(l)&&t.unshift(l),(n.getAttribute("class")||"").split(" ").forEach((function(e){e&&t.push(e)}));var c=o!==a;if(r.defaultStyles[s])for(i in r.defaultStyles[s])r.defaultStyles[s].hasOwnProperty(i)&&(!c||c&&-1===i.indexOf("margin")&&-1===i.indexOf("border"))&&("decoration"===i?(Array.isArray(e.ret[i])||(e.ret[i]=[]),e.ret[i].push(r.defaultStyles[s][i])):e.ret[i]=r.defaultStyles[s][i]);"tr"===s&&(c=!1),(i=r.parseStyle(n,c)).forEach((function(t){if("decoration"===t.key)Array.isArray(e.ret[t.key])||(e.ret[t.key]=[]),e.ret[t.key].push(t.value);else if(e.ret.margin&&0===t.key.indexOf("margin"))switch(t.key){case"marginLeft":e.ret.margin[0]=t.value;break;case"marginTop":e.ret.margin[1]=t.value;break;case"marginRight":e.ret.margin[2]=t.value;break;case"marginBottom":e.ret.margin[3]=t.value}else e.ret[t.key]=t.value}))})),e.ret.style=t,e.ret},this.parseStyle=function(e,t){var a=e.getAttribute("style")||"";a=a.split(";"),e.getAttribute("width")&&a.unshift("width:"+e.getAttribute("width")+"px"),e.getAttribute("height")&&a.unshift("height:"+e.getAttribute("height")+"px");var r=a.map((function(e){return e.toLowerCase().split(":")})),n=[],o=[],i=e.nodeName.toUpperCase(),s=this;if(r.forEach((function(e){if(2===e.length){var a=e[0].trim(),r=e[1].trim();switch(a){case"margin":if(t)break;1===(r=r.split(" ")).length?r=[r[0],r[0],r[0],r[0]]:2===r.length?r=[r[1],r[0]]:3===r.length?r=[r[1],r[0],r[1],r[2]]:4===r.length&&(r=[r[3],r[0],r[1],r[2]]),r.forEach((function(e,t){r[t]=s.convertToUnit(e)})),-1===r.indexOf(!1)&&n.push({key:a,value:r});break;case"text-align":n.push({key:"alignment",value:r});break;case"font-weight":"bold"===r&&n.push({key:"bold",value:!0});break;case"text-decoration":n.push({key:"decoration",value:s.toCamelCase(r)});break;case"font-style":"italic"===r&&n.push({key:"italics",value:!0});break;case"font-family":n.push({key:"font",value:r.split(",")[0].replace(/"|^'|^\s*|\s*$|'$/g,"").replace(/^([a-z])/g,(function(e){return e[0].toUpperCase()})).replace(/ ([a-z])/g,(function(e){return e[1].toUpperCase()}))});break;case"color":n.push({key:"color",value:s.parseColor(r)});break;case"background-color":n.push({key:"TD"===i||"TH"===i?"fillColor":"background",value:s.parseColor(r)});break;case"text-indent":n.push({key:"leadingIndent",value:s.convertToUnit(r)});break;case"white-space":n.push({key:"preserveLeadingSpaces",value:"break-spaces"===r||"pre"===r.slice(0,3)});break;default:if("border"===a||0===a.indexOf("border-left")||0===a.indexOf("border-top")||0===a.indexOf("border-right")||0===a.indexOf("border-bottom"))t||o.push({key:a,value:r});else{if(t&&(0===a.indexOf("margin-")||"width"===a||"height"===a))break;if(0===a.indexOf("padding"))break;if(a.indexOf("-")>-1&&(a=s.toCamelCase(a)),r){var l=s.convertToUnit(r);n.push({key:a,value:!1===l?r:l})}}}}})),o.length>0){var l=[],c=[];o.forEach((function(e){var t,a=e.value.split(" "),r=a[0].replace(/(\d+)(\.\d+)?([^\d]+)/g,"$1$2 ").trim(),n=-1;if(e.key.indexOf("-left")>-1?n=0:e.key.indexOf("-top")>-1?n=1:e.key.indexOf("-right")>-1?n=2:e.key.indexOf("-bottom")>-1&&(n=3),n>-1)l[n]=r>0;else for(t=0;t<4;t++)l[t]=r>0;if(a.length>2){var o=a.slice(2).join(" ");if(n>-1)c[n]=s.parseColor(o);else for(t=0;t<4;t++)c[t]=s.parseColor(o)}}));for(var f=0;f<4;f++)l.length>0&&void 0===l[f]&&(l[f]=!0),c.length>0&&void 0===c[f]&&(c[f]="#000000");l.length>0&&n.push({key:"border",value:l}),c.length>0&&n.push({key:"borderColor",value:c})}return n},this.toCamelCase=function(e){return e.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}))},this.parseColor=function(e){var t=new RegExp("^#([0-9a-f]{3}|[0-9a-f]{6})$"),a=new RegExp("^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$"),r=new RegExp("^[a-z]+$");if(t.test(e))return e;if(a.test(e)){for(var n=a.exec(e).slice(1),o=0;o<3;o++){var i=+n[o];i>255&&(i=255);var s="0"+i.toString(16);s=s.slice(-2),n[o]=s}return"#"+n.join("")}return r.test(e)?"transparent"===e?"white":e:(console.error('Could not parse color "'+e+'"'),e)},this.convertToUnit=function(e){if(!isNaN(parseFloat(e))&&isFinite(e))return 1*e;var t=(e+"").trim().match(/^(\d+(\.\d+)?)(pt|px|r?em|cm)$/);if(!t)return!1;switch(e=t[1],t[3]){case"px":e=Math.round(.75292857248934*e);break;case"em":case"rem":e*=12;break;case"cm":e=Math.round(28.34646*e)}return 1*e};var a=this.convertHtml(e);return"string"==typeof a&&(a={text:a}),a}e.exports=function(e,a){return new t(e,a)}}}]);